dayly_analysis_task:
  description: |
    Use the provided tools to analyze all workout data for athlete {athlete} on {date}:
    - athlete_reader provides profile information about the athlete.
    - daily_workout_reader reads the detailed data from each workout file for the athlete on the given date.
    - athlete_plan_lookup lists planned workouts for the athlete.

    **STOP RULE:**
    If there is no workout data for this date, *do not* perform any analysis.
    Output a message to the head coach stating that data for {date} is missing.
    Do not attempt to infer or invent activity details.

    When data is present:
    - Focus only on relevant, context-appropriate observations for the recorded sport type.
    - Ignore minor data spikes or dropouts in sensor streams unless they dominate large portions of the file.
    - For cycling, cadence is in RPM and power values compared to FTP etc.
    - For running, cadence is in steps per minute (SPM); do not confuse running cadence with cycling cadence.
    - Running "power" from a GPS watch or foot pod is not directly comparable to cycling power; only comment on running power in the context of running norms.
    - Ignore one-off abnormal values at activity start (low power/cadence during GPS lock-on, etc.).
    - Flag genuine anomalies only if they might materially affect interpretation of today's session.

  expected_output: |
    If no data is available for {date}, output ONLY:
    "No workout data available for {athlete} on {date}."
    If data is available:
    - Provide a short summary of the day's planned and completed workouts in English.
    - Give relevant detailed analysis focused on performance and execution.
    - Flag anomalies only where they could materially change understanding of the session.
    - Avoid irrelevant technical warnings unrelated to performance.
  markdown: true
  output_file: "{output_dir}/{date}_details.md"

daily_feedback_task:
  description: |
    Using the provided analysis report for {athlete} at {date}, read profile information about the athlete and
    the planned workouts for that date and 2 days after {date}. Then, create a short, clear, and motivating feedback 
    message for the athlete. 

    **IMPORTANT:**  
    If there are no analysis report or workouts for the given date, *immediately* state this fact and 
    end the response. Do not speculate about possible activities, do not provide generic advice, and 
    do not attempt to fill in missing details. Simply inform the athlete that there is no data for 
    the date in question.

    Verify that the analysis report corresponds to the date in question by listing available workouts for the athlete.

    When data *is* present:
    - Focus solely on the workout(s) completed on this date.
    - Optionally use a tool to list available workouts for the athlete to verify the report.
    - Acknowledge today's effort.
    - Highlight 1–2 positive aspects from the report, in plain language.
    - Mention 1 improvement point, phrased constructively.
    - Provide 1 concrete next step relevant to the coming day(s), without multiple options.
    - Avoid detailed metric explanations unless essential.
    - Avoid long-term recommendations; limit feedback to the immediate context.
    - Keep the feedback concise (max ~100–150 words), so it can be read in less than a minute.
    - Use a warm, supportive, but professional tone.
    - The feedback should be in the athlete's preferred language as given in the context.

  expected_output: |
    The entire message should be written in the athlete's preferred language.
    If there is no data for the given date, output ONLY:
    "No workout data is available for [date]."
    Otherwise, output a concise, well-structured feedback message addressed to the athlete, containing:
    1. Greeting / quick acknowledgement of today's effort.
    2. 1–2 positives about the workout performance.
    3. 1 constructive improvement point.
    4. 1 concrete next step or action for the upcoming day(s).
    5. Short closing motivation sentence.
    
  markdown: true
  output_file: "{output_dir}/{date}_feedback.md"

translate_task:
  description: |
    Translate the provided coaching feedback from English into the athlete's 
    preferred_language as given in the context.
    Keep the tone warm, supportive, and professional.
    Retain any sports metrics or key data exactly as presented.
  expected_output: |
    A fluent, natural translation of the provided feedback.
    All technical terms should remain accurate and easy to understand.
  output_file: "{output_dir}/{date}_daily.md"

long_term_feedback_task:
  description: |
    Using the provided technical analysis reports and planned workouts, create a long-term feedback message for athlete {athlete}.
    Find all analysis feedback for athlete {athlete} from the past {days_history} days up to and including {date}.
    Also, find all planned workouts for the upcoming {days_ahead} days starting from {date}.

    Using data on the athlete's training load and execution over the past {days_history} days,
    along with a list of planned workouts for the upcoming {days_ahead} days,
    create a clear, constructive, and motivating feedback message that addresses long-term progression.
    You should obtain the athlete's profile, get analysis history and upcoming training plan from the relevant tools.

    Guidelines:
    - Use only the workouts provided in the historical and planned data; do not invent or assume missing information.
    - Evaluate recent load metrics (e.g., total training time, TSS, intensity distribution, key sessions completed).
    - Identify positive patterns or improvements over time.
    - Highlight sustained issues or potential risks (e.g., overtraining signs, neglected training zones).
    - Tie recommendations directly to the upcoming planned sessions.
    - Keep suggestions relevant and actionable inside the given forward_period.
    - Avoid deep technical details unless they affect the overall strategy.

  expected_output: |
    A well-structured message in the athlete's preferred language containing:
    1. Short opening acknowledgement of recent efforts.
    2. 2–3 key observations from recent training (both positives and concerns).
    3. Evaluation of readiness or focus going into the next planned period.
    4. 1–2 specific recommendations for upcoming sessions (adjustments or emphasis).
    5. Short closing motivation.
    Length ~150–225 words

    A short appendix, limited to 2-3 sections going in more detail on the given specific recommendations. Give references to specific past sessions, to 
    relevant literature or training principles.

  markdown: true
  output_file: "{output_dir}/{date}_feedback.md"

long_term_analysis_task:
  description: |
      Analyze total training load and execution quality for athlete {athlete} for the past {days_history} days up to and including {date}.
      You should obtain the workouts using relevant tools. 

      As an expert:
      - Decide which metrics or patterns are most relevant in this context.
      - Identify clear indicators of progress or improvement (fitness, consistency, skill, etc.).
      - Identify any risks or warnings (fatigue, imbalance, missed training types).
      - Pinpoint areas or themes the Head Coach could address with the athlete.
      - Ignore irrelevant minor anomalies or technical oddities unless they materially change interpretation.
      
      Provide a balanced analysis that the Head Coach can use for long-term feedback.

  expected_output: |
    A structured report in English containing:
    1. Summary of key relevant metrics and observations for the period.
    2. Progress indicators that show improvement in any aspect of training.
    3. Risks or warnings that may require attention.
    4. Suggested focus areas/themes for the Head Coach to discuss with the athlete.
    Avoid unrelated technical detail.

  markdown: true
  output_file: "{output_dir}/{date}_analysis.md"

plan_suggestion_task:
  description: |
    Check if athlete {athlete} has sufficient upcoming workout days planned and suggest new training plans if needed.
    
    Use athlete_plan_lookup to check upcoming workouts for the next {days_ahead} days starting from {date}.
    If there are {threshold} or fewer workout days planned, analyze historical training patterns and suggest new workouts.
    
    **Process:**
    1. Check upcoming planned workouts for {days_ahead} days starting from {date}
    2. Count the number of days with planned workouts
    3. If <= {threshold} workout days are planned:
       - Use athlete_plan_lookup to get historical training patterns from past {lookback_days} days
       - Use athlete_reader to get athlete profile information
       - Use long_time_analysis_loader to get the latest long-term analysis insights
       - Analyze training patterns, intensity distribution, and progression needs
       - Suggest new workouts in the same format as plans.yaml
    4. If > {threshold} workout days are planned, confirm sufficient planning exists
    
    **Guidelines for suggestions:**
    - Base suggestions on historical training patterns and progression
    - Incorporate insights from the latest long-term analysis if available
    - Maintain appropriate training load and intensity distribution
    - Consider athlete's goals and current fitness level
    - Follow established periodization principles
    - Suggest workouts in the exact format used in plans.yaml (date: activities list)
    - Fill gaps to ensure adequate training stimulus while avoiding overload
    
  expected_output: |
    If sufficient workouts are planned (> {threshold} days):
    "Training plan check completed. {athlete} has adequate workouts planned for the next {days_ahead} days."
    
    If insufficient workouts are planned (<= {threshold} days):
    A structured report containing:
    1. Current planning status (number of days with workouts vs threshold)
    2. Analysis of recent training patterns and athlete profile
    3. Suggested new workouts in plans.yaml format:
       ```
       d2025-MM-DD:
         - Activity description with duration/intensity
         - Additional activity if needed
       ```
    4. Rationale for each suggested workout based on training principles
    5. Integration recommendations for the suggested workouts
    
  markdown: true
  output_file: "{output_dir}/{date}_plan_suggestion.md"